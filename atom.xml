<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ZTFDeveloper&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://ztfsmart.github.io/"/>
  <updated>2017-11-09T08:54:46.068Z</updated>
  <id>https://ztfsmart.github.io/</id>
  
  <author>
    <name>ZTF</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>我的第一个博客--iPhone X适配</title>
    <link href="https://ztfsmart.github.io/2017/11/09/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8D%9A%E5%AE%A2/"/>
    <id>https://ztfsmart.github.io/2017/11/09/我的第一个博客/</id>
    <published>2017-11-09T08:46:40.000Z</published>
    <updated>2017-11-09T08:54:46.068Z</updated>
    
    <content type="html"><![CDATA[<p>11月9日更—-八.Home Indicator</p><p>===========================<br>10月25日更—-增加iPhone X需要适配的尺寸的宏定义—六–1</p><p>====================================</p><p>#一.APP在iPhoneX运行后不能占满屏幕,上下都有多余的边</p><blockquote><p>解决方法:把旧的image.xcassets中的LaunchImage删掉,重新创建并在Images.xcassets中为iPhone X添加一个LaunchImage，新的启动图尺寸为1125px × 2436px(375pt × 812pt @3x).</p></blockquote><p><img src="http://img.blog.csdn.net/20170920103636033?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvemh1dGlhbmZ1NTIx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p><blockquote><p>问题原因:1.应用启动后的显示尺寸会根据启动图的大小来显示,因为旧的工程没有iPhoneX的尺寸,所以就会出现上下有多余边的问题.<br>2.旧工程工程的xcassets没有iPhoneX,所以需要把旧的删掉,重新创建,才可以添加iPhoneX尺寸的启动</p></blockquote><p>#二.局部适配</p><p>因为iPhoneX的屏幕上下边角是有弧度的,如果没有适配弧度外是看不到的</p><blockquote><p>iOS11 以前，我们布局时，视图的 top 和 bottom 一般参照的是 Top Layout Guide 和 Bottom Layout Guide<br>iOS11 以后，那两个参照已经 deprecated (过时)了，而被 Safe Area 取代。<br>Safe Area 要求最低支持 iOS9.0<br>最后总结SafeArea</p></blockquote><p>#三.titleview适配<br><img src="http://img.blog.csdn.net/20170921114722128?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvemh1dGlhbmZ1NTIx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""><br>很多APP都会在navigation的titleview上添加搜索框,在iOS11上回出现这种情况的偏移</p><blockquote><p>解决方法:<br>在替换titleview的view里实现方法:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (CGSize)intrinsicContentSize &#123;</div><div class="line">    return UILayoutFittingExpandedSize;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p></blockquote><p>#四.适配下拉刷新<br><img src="http://img.blog.csdn.net/20170921115349447?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvemh1dGlhbmZ1NTIx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""><br>下拉在正常状态下会有尺寸偏移</p><blockquote><p>解决方法1:在controller中添加</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">if (@available(iOS 11.0, *)) &#123;</div><div class="line">    self.tableView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;</div><div class="line">&#125; else &#123;</div><div class="line">    self.automaticallyAdjustsScrollViewInsets = NO;</div><div class="line">&#125;</div></pre></td></tr></table></figure><blockquote><p>解决方法2:</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">self.automaticallyAdjustsScrollViewInsets = NO;</div><div class="line">self.extendedLayoutIncludesOpaqueBars = YES;</div><div class="line">self.edgesForExtendedLayout = UIRectEdgeTop;</div></pre></td></tr></table></figure><blockquote><p>问题原因:多数情况是在隐藏导航栏出现的,因为iOS11后tableview的automaticallyAdjustsScrollViewInsets属性被废弃了，顶部就多了一定的inset，也可能是SafeArea(安全区域)的原因,关于SafeArea(安全区域)适配下边会写.</p></blockquote><p>如果还是有尺寸偏移那就是tableview的另一个解决方法</p><p>#五.tableview间隙问题</p><blockquote><p>解决方法:实现-tableView: viewForFooterInSection: 和 -tableView: viewForHeaderInSection:方法.或者设置tableview的estimatedRowHeight estimatedSectionHeaderHeight estimatedSectionFooterHeight三个属性为0</p><p>问题原因:iOS 11中如果不实现-tableView: viewForFooterInSection: 和 -tableView: viewForHeaderInSection:，那么-tableView: heightForHeaderInSection:和- tableView: heightForFooterInSection:不会被调用。<br>这是因为在tableview中的 estimatedRowHeight estimatedSectionHeaderHeight estimatedSectionFooterHeight三个高度估算属性由默认的0变成了UITableViewAutomaticDimension，导致高度计算不对。</p><p>#六.SafeArea适配<br><img src="http://img.blog.csdn.net/20170927170324968?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvemh1dGlhbmZ1NTIx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>1.官方的安全区域的指导图,旧的项目运行在iPhone X上最大显著的问题就是导航和底部tabbar的位置偏移,因为之前的导航高度为64,随意程序基本都写的死值,适配的话就各种苦逼了,xib和代码的各有各的哭,总之所有的地都要通过判断是否是iPhoneX来适配高度.<br>为了适配我添加了全局的宏<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">//是否是iPhone X</div><div class="line">#define is_iPhoneX          ([UIScreen instancesRespondToSelector:@selector(currentMode)] ? CGSizeEqualToSize(CGSizeMake(1125, 2436), [[UIScreen mainScreen] currentMode].size) : NO)</div><div class="line">//状态栏高度</div><div class="line">#define StatusBarHeight     (is_iPhoneX ? 44.f : 20.f)</div><div class="line">// 导航高度</div><div class="line">#define NavigationBarHeight 44.f</div><div class="line">// Tabbar高度.   49 + 34 = 83</div><div class="line">#define TabbarHeight        (is_iPhoneX ? 83.f : 49.f)</div><div class="line">// Tabbar安全区域底部间隙</div><div class="line">#define TabbarSafeBottomMargin  (is_iPhoneX ? 34.f : 0.f)</div><div class="line">// 状态栏和导航高度</div><div class="line">#define StatusBarAndNavigationBarHeight  (is_iPhoneX ? 88.f : 64.f)</div><div class="line"></div><div class="line">#define ViewSafeAreInsets(view) (&#123;UIEdgeInsets insets; if(@available(iOS 11.0, *)) &#123;insets = view.safeAreaInsets;&#125; else &#123;insets = UIEdgeInsetsZero;&#125; insets;&#125;)</div></pre></td></tr></table></figure></p></blockquote><p>2.在Storyboard中有SafeArea的选项,但是只支持iOS9以上,你的老板肯定是不会同意的,所以慢慢改吧.</p><p>3.如果使用了Masonry 进行布局，就要适配safeArea<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">if (@available(iOS 11.0, *)) &#123;</div><div class="line">    make.edges.equalTo(self.view.safeAreaInsets);</div><div class="line">&#125; else &#123;</div><div class="line">    make.edges.equalTo(self.view);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>4.在没有适配的页面底部是到屏幕低的,需要设置到安全区域内,把底部的黑条留出来.<br>比如天猫的适配:<br><img src="http://img.blog.csdn.net/20170927174123935?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvemh1dGlhbmZ1NTIx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p><p>#七.UIImagePickerController 设置导航背景图</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[self.navigationBar setBackgroundImage:[UIImage imageNamed:@&quot;navBg&quot;] forBarMetrics:UIBarMetricsDefault];</div></pre></td></tr></table></figure><p>这样设置发现对 UIImagePickerController 不起作用，需要使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">self.navigationBar.barTintColor = [UIColor blackColor];</div></pre></td></tr></table></figure></p><p>#八.Home Indicator<br>Home indicator 的设置类似于 prefersStatusBarStyle，iOS 11 增加了 UIViewController 的一个 UIHomeIndicatorAutoHidden 分类来控制 home 键的自动隐藏。通常在全屏播放视频，全屏游戏等场景下会需要用到此特性。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">@interface UIViewController (UIHomeIndicatorAutoHidden)</div><div class="line"></div><div class="line">// Override to return a child view controller or nil. If non-nil, that view controller&apos;s home indicator auto-hiding will be used. If nil, self is used. Whenever the return value changes, -setNeedsHomeIndicatorAutoHiddenUpdate should be called.</div><div class="line">- (nullable UIViewController *)childViewControllerForHomeIndicatorAutoHidden API_AVAILABLE(ios(11.0)) API_UNAVAILABLE(watchos, tvos);</div><div class="line"></div><div class="line">// Controls the application&apos;s preferred home indicator auto-hiding when this view controller is shown.</div><div class="line">- (BOOL)prefersHomeIndicatorAutoHidden API_AVAILABLE(ios(11.0)) API_UNAVAILABLE(watchos, tvos);</div><div class="line"></div><div class="line">// This should be called whenever the return values for the view controller&apos;s home indicator auto-hiding have changed.</div><div class="line">- (void)setNeedsUpdateOfHomeIndicatorAutoHidden API_AVAILABLE(ios(11.0)) API_UNAVAILABLE(watchos, tvos);</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure><p>苹果并没有提供可以手动改变 home indicator 颜色的接口给开发者。因为苹果并不希望我们手动更改 home indicator 的颜色，而应该遵循其自动切换颜色的特性（Home indicator 会根据底色的不同自动切换黑色或白色）。</p><p><a href="https://developer.apple.com/ios/human-interface-guidelines/overview/iphone-x/" target="_blank" rel="external">官方适配指南</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;11月9日更—-八.Home Indicator&lt;/p&gt;
&lt;p&gt;===========================&lt;br&gt;10月25日更—-增加iPhone X需要适配的尺寸的宏定义—六–1&lt;/p&gt;
&lt;p&gt;================================
      
    
    </summary>
    
    
      <category term="随笔" scheme="https://ztfsmart.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://ztfsmart.github.io/2017/10/27/hello-world/"/>
    <id>https://ztfsmart.github.io/2017/10/27/hello-world/</id>
    <published>2017-10-27T06:48:09.978Z</published>
    <updated>2017-10-27T06:48:09.978Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
  </entry>
  
</feed>
